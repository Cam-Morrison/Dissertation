<div class="content mat-elevation-z5">

  <div>
    <button mat-button color="primary" (click)="onBack()">
      <mat-icon>arrow_back</mat-icon>
      <p>Go back</p>
    </button>
    <button mat-button color="primary" (click)="addToWatchlist()">
      <mat-icon>add</mat-icon>
      <p>Add to watchlist</p>
    </button>

    <mat-form-field appearance="fill">
      <mat-label>Change chart</mat-label>
      <mat-select [(value)]="selectedChart">
        <mat-option value="area">Area</mat-option>
        <mat-option value="candlestick">Candle stick</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <!-- Loader -->
  <div class="spinbox" *ngIf="isLoading">
    <mat-progress-spinner color="primary" mode="indeterminate">
    </mat-progress-spinner>
  </div>
  <stockChart
    *ngIf="!isLoading"
    [dataPoints]="dataPoints"
    [ticker]="ticker!"
    [chartType]="selectedChart"
  ></stockChart>

  <mat-expansion-panel [expanded]="panelOpenState">
    <mat-expansion-panel-header matRipple>
      <mat-panel-title> <b>Stock Information</b> </mat-panel-title>
    </mat-expansion-panel-header>
    <div *ngIf="detailsLoaded">
      <h3>
        <span *ngIf="details.name"> <strong>{{details.name}} </strong></span>
        <span *ngIf="details.name == null"> There is no information on this security</span>
      </h3>
      <p>
        <span *ngIf="details.description"> {{details.description}} </span>
      </p>
      <div class="flexbox"> 
        <p>
          <span *ngIf="details.sector"> Sector - {{details.sector}} </span>
          <span *ngIf="details.primaryExchange"> Primary exchange  - {{details.primaryExchange}} </span>
          <span *ngIf="details.employees">  Employes - {{details.employees}} </span>
          <span *ngIf="details.country"> Based in - {{details.city}}, {{details.country}}</span>
          <span *ngIf="details.companyUrl"><a href={{details.companyUrl}}> {{details.companyUrl}}</a></span>
        </p>
      </div>  
    </div>
  </mat-expansion-panel>

  <mat-expansion-panel *ngIf="AIassistance" [expanded]="panelOpenState">
    <mat-expansion-panel-header matRipple>
      <mat-panel-title> <b>A.I. Assistance</b> </mat-panel-title>
    </mat-expansion-panel-header>
    <div *ngIf="detailsLoaded">
      <div class="flexbox"> 
        <p>
          Based upon our modelling, A.I. Assistance has predicted the following prices.
          <mat-icon
          class="info"
          [matTooltipClass]="{ 'tool-tip': true }"
          aria-label="Icon that displays a tooltip when focused or hovered over"
          matTooltip="A.I. assist is in its beta trial and could display incorrect answers. It should not be interpreted as investment advice."
        >
          information
        </mat-icon>
        </p>
          <table>
            <tr>
              <th>Current</th>
              <th>1 Day</th>
              <th>1 Week</th>
              <th>1 Month</th>
              <th>From now</th>
            </tr>
            <tr>
              <td>${{lastPrice | number : '1.2-2'}}</td>
              <td>${{prediction[0] | number : '1.2-2'}}</td>
              <td>${{prediction[6] | number : '1.2-2'}}</td>
              <td>${{prediction[29] | number : '1.2-2'}}</td>
              <td>
                <ng-template *ngIf="prediction[29] >= lastPrice!"><mat-icon class="positive">trending_up</mat-icon></ng-template>
                <ng-template *ngIf="prediction[29] <= lastPrice!"><mat-icon class="negative">trending_down</mat-icon></ng-template>
              </td>
            </tr>
          </table>
        <p>
          Based upon current prices, this would be a short term (1 month)
          <ng-template *ngIf="prediction[29] > lastPrice!; else lessTxt">gain.</ng-template>
          <ng-template #lessTxt>loss.</ng-template>
       
           It is important to note, 
          stocks are volitile and the safest way to particpate is to average money consistently into the stocks you choose instead of trying to time the markets.
        </p>
      </div>  
    </div>
  </mat-expansion-panel>
</div>
